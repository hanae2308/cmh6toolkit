<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸ“¤ CMH6 Newsletter Toolkit</title>
  <style>
    :root {
      --primary: #3a86ff;
      --secondary: #8338ec;
      --success: #06d6a0;
      --warning: #ffbe0b;
      --danger: #ff006e;
      --dark: #212529;
      --gray: #6c757d;
      --light-gray: #e9ecef;
      --white: #ffffff;
    }
    
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
      color: var(--dark);
      line-height: 1.4;
      font-size: 14px;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem;
    }
    
    header {
      text-align: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
    }
    
    h1 {
      color: var(--primary);
      font-size: 1.5rem;
      margin: 0.5rem 0;
      font-weight: 600;
    }
    
    .subtitle {
      color: var(--gray);
      font-size: 0.9rem;
      margin: 0;
    }
    
    .section {
      margin-bottom: 2rem;
      text-align: center;
    }
    
    .section-title {
      font-size: 1rem;
      color: var(--primary);
      margin: 0 0 1rem 0;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .tool-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0 rem;
      justify-items: center;
      margin: 0 auto;
      max-width: 700px;
    }
    
    .tool-card {
      background: var(--white);
      border-radius: 6px;
      padding: 0.8rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      transition: all 0.2s ease;
      cursor: pointer;
      border: 1px solid var(--light-gray);
      width: 100%;
      max-width: 200px;
      text-align: center;
    }
    
    .tool-card:hover {
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      border-color: var(--primary);
    }
    
    .tool-icon {
      color: var(--primary);
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }
    
    .tool-title {
      font-size: 0.95rem;
      margin: 0.3rem 0;
      color: var(--dark);
      font-weight: 500;
    }
    
    .tool-desc {
      color: var(--gray);
      font-size: 0.8rem;
      margin: 0;
    }
    
    /* Tool Section Styles */
    .tool-section {
      display: none;
      background: white;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      margin: 1.5rem auto;
      max-width: 700px;
      border: 1px solid var(--light-gray);
    }
    
    .tool-section.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .back-btn {
      background: none;
      border: none;
      color: var(--primary);
      font-size: 0.9rem;
      cursor: pointer;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.3rem 0;
    }
    
    .section-title {
      font-size: 1.2rem;
      color: var(--dark);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      justify-content: center;
    }
    
    .upload-area {
      border: 2px dashed #ced4da;
      border-radius: 8px;
      padding: 2rem 1rem;
      text-align: center;
      margin-bottom: 1rem;
      transition: all 0.3s;
    }
    
    .upload-area:hover {
      border-color: var(--primary);
    }
    
    .file-label {
      display: inline-block;
      padding: 0.6rem 1rem;
      background: #f0f5ff;
      border-radius: 6px;
      color: var(--primary);
      cursor: pointer;
      margin-top: 0.8rem;
      font-weight: 500;
      transition: all 0.3s;
      font-size: 0.8rem;
    }
    
    .file-label:hover {
      background: #e0ebff;
    }
    
    .file-input {
      display: none;
    }
    
    .action-btns {
      display: flex;
      flex-wrap: wrap;
      gap: 0.8rem;
      margin-top: 1rem;
      justify-content: center;
    }
    
    .btn {
      display: inline-block;
      padding: 0.6rem 1rem;
      background: var(--primary);
      color: white;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 500;
      transition: background 0.3s;
      border: none;
      cursor: pointer;
      font-size: 0.8rem;
      min-width: 120px;
      text-align: center;
    }
    
    .btn:hover {
      background: #2a75e6;
    }
    
    .btn-secondary {
      background: var(--gray);
    }
    
    .btn-secondary:hover {
      background: #5a6268;
    }
    
    .btn-success {
      background: var(--success);
    }
    
    .btn-success:hover {
      background: #05a181;
    }
    
    .btn-warning {
      background: var(--warning);
    }
    
    .btn-warning:hover {
      background: #e6a700;
    }
    
    .btn-danger {
      background: var(--danger);
    }
    
    .btn-danger:hover {
      background: #d0006e;
    }
    
    textarea {
      width: 100%;
      min-height: 150px;
      padding: 0.8rem;
      border: 1px solid #ced4da;
      border-radius: 6px;
      font-family: inherit;
      margin-bottom: 1rem;
      font-size: 0.85rem;
    }
    
    .results-area {
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid #eee;
    }
    
    .message-info {
      margin: 0.5rem 0;
      padding: 0.8rem;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.85rem;
    }
    
    .download-link {
      display: block;
      margin: 0.3rem 0;
      font-weight: bold;
      color: #0066cc;
      text-decoration: none;
      font-size: 0.85rem;
    }
    
    .message-details {
      font-size: 0.75rem;
      color: #666;
      margin-top: 0.3rem;
    }
    
    #progress {
      margin: 0.5rem 0;
      display: none;
      text-align: center;
      font-size: 0.85rem;
    }
    
    .radio-group {
      display: flex;
      gap: 1rem;
      margin: 0.8rem 0;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .radio-option {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }
    
    .radio-option input[type="radio"] {
      width: 16px;
      height: 16px;
      border: 2px solid var(--primary);
      border-radius: 50%;
      outline: none;
      cursor: pointer;
    }
    
    .radio-option input[type="radio"]:checked {
      background-color: var(--primary);
    }
    
    .radio-option label {
      font-size: 0.85rem;
      color: var(--dark);
      cursor: pointer;
    }
    
    footer {
      text-align: center;
      padding: 1rem 0;
      margin-top: 30rem;
      color: var(--gray);
      font-size: 0.7rem;
      border-top: 1px solid var(--light-gray);
    }

    @media (max-width: 600px) {
      .tool-grid {
        grid-template-columns: repeat(2, 1fr);
        max-width: 420px;
      }
      
      .tool-card {
        max-width: 180px;
      }
      
      .action-btns {
        flex-direction: column;
        align-items: center;
      }
      
      .btn {
        width: 100%;
      }
    }

    @media (max-width: 400px) {
      .tool-grid {
        grid-template-columns: 1fr;
        max-width: 220px;
      }
      
      .tool-card {
        max-width: 200px;
      }
    }

    /* DNS Generator Specific Styles */
    .tabs {
      display: flex;
      border-bottom: 1px solid var(--light-gray);
      margin-bottom: 1rem;
    }
    
    .tab {
      padding: 0.5rem 1rem;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.85rem;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      color: var(--gray);
    }
    
    .tab:hover {
      color: var(--primary);
    }
    
    .tab.active {
      border-bottom-color: var(--primary);
      color: var(--primary);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    
    .input-section {
      margin-bottom: 1rem;
    }
    
    .input-section label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .input-hint {
      font-size: 0.75rem;
      color: var(--gray);
      margin-bottom: 0.5rem;
    }
    
    .output-container {
      border: 1px solid var(--light-gray);
      border-radius: 6px;
      margin-top: 1rem;
    }
    
    .output-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      background-color: var(--light-gray);
      border-bottom: 1px solid var(--light-gray);
    }
    
    .output-title {
      font-weight: 500;
      font-size: 0.85rem;
    }
    
    .output-actions {
      display: flex;
      gap: 0.5rem;
    }
    
    .result {
      padding: 1rem;
      font-family: monospace;
      font-size: 0.8rem;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }
	 /* Back to Top Button Styles */
    .back-to-top {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 50px;
      height: 50px;
      background: #4361ee;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      border: none;
    }
    
    .back-to-top:hover {
      background: #3f37c9;
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
    }
    
    .back-to-top.visible {
      opacity: 1;
      visibility: visible;
    }
    
    .back-to-top i {
      transition: transform 0.3s;
    }
    
    .back-to-top:hover i {
      transform: translateY(-2px);
    }
    
    .back-to-top::after {
      content: "Refresh & Back to Top";
      position: absolute;
      right: 60px;
      white-space: nowrap;
      background: #4361ee;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      font-size: 0.9rem;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .back-to-top:hover::after {
      opacity: 1;
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>CMH6 Newsletter Toolkit</h1>
      <p class="subtitle">Essential tools for newsletter processing</p>
    </header>
    
    <!-- Warmup Section -->
    <div class="section">
      <div class="section-title">Warmup</div>
      <div class="tool-grid">
        <div class="tool-card" data-tool="single-transformer">
          <div class="tool-icon"><i class="fas fa-envelope"></i></div>
          <h3 class="tool-title">Single Header Transformer</h3>
          <p class="tool-desc">Modify headers in individual newsletter source</p>
        </div>
        
        <div class="tool-card" data-tool="bulk-transformer">
          <div class="tool-icon"><i class="fas fa-envelopes-bulk"></i></div>
          <h3 class="tool-title">Bulk Header Transformer</h3>
          <p class="tool-desc">Modify headers across multiple newsletters</p>
        </div>
      </div>
    </div>
    
    <!-- Fixation Section -->
    <div class="section">
      <div class="section-title">Fixation</div>
      <div class="tool-grid">
        <div class="tool-card" data-tool="single-remover">
          <div class="tool-icon"><i class="fas fa-envelope-open-text"></i></div>
          <h3 class="tool-title">Single Header Remover</h3>
          <p class="tool-desc">Remove headers from single newsletter</p>
        </div>
        
        <div class="tool-card" data-tool="bulk-remover">
          <div class="tool-icon"><i class="fas fa-trash-alt"></i></div>
          <h3 class="tool-title">Bulk Header Remover</h3>
          <p class="tool-desc">Remove multiple newsletter headers</p>
        </div>
      </div>
    </div>
    
    <!-- Other Tools Section -->
    <div class="section">
      <div class="section-title">Other Tools</div>
      <div class="tool-grid">
        <div class="tool-card" data-tool="mbox-converter">
          <div class="tool-icon"><i class="fas fa-box-archive"></i></div>
          <h3 class="tool-title">MBOX Converter</h3>
          <p class="tool-desc">Convert MBOX to individual EML files</p>
        </div>
        
        <div class="tool-card" data-tool="domain-extractor">
          <div class="tool-icon"><i class="fas fa-globe"></i></div>
          <h3 class="tool-title">IP Domain Extractor</h3>
          <p class="tool-desc">Extract domains and IPs  </p>
        </div>
        
     
    </div>
    
    <!-- Tool Sections -->
    
    <!-- Single Email Header Transformer -->
    <div id="single-transformer" class="tool-section">
      <button class="back-btn"><i class="fas fa-arrow-left"></i> Back to Tools</button>
      <h2 class="section-title"><i class="fas fa-envelope"></i> Single Newsletter Header Transformer</h2>
      
      <textarea id="singleInput" placeholder="Paste your newsletter source here..."></textarea>
      
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" id="singleRdns" name="singleReplace" value="RDNS" checked>
          <label for="singleRdns">Use [RDNS]</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="singlePrpath" name="singleReplace" value="P_RPATH">
          <label for="singlePrpath">Use [P_RPATH]</label>
        </div>
      </div>
      
      <div class="action-btns">
        <button id="singleTransformBtn" class="btn"><i class="fas fa-magic"></i> Transform Headers</button>
        <button id="singleIpBtn" class="btn btn-warning"><i class="fas fa-plus"></i> Add [IP] to Subject</button>
        <button id="singleCopyBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copy Output</button>
        <button id="singleClearBtn" class="btn btn-danger"><i class="fas fa-trash"></i> Clear All</button>
      </div>
      
      <textarea id="singleOutput" placeholder="Transformed headers will appear here..." readonly></textarea>
    </div>
    
    <!-- Bulk Email Header Transformer -->
    <div id="bulk-transformer" class="tool-section">
      <button class="back-btn"><i class="fas fa-arrow-left"></i> Back to Tools</button>
      <h2 class="section-title"><i class="fas fa-envelopes-bulk"></i> Bulk Newsletter Header Transformer</h2>
      
      <div class="upload-area" id="bulkUploadArea">
        <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--success); margin-bottom: 0.8rem;"></i>
        <p>Drag and drop multiple .eml files or .zip archives here</p>
        <p>or</p>
        <label for="bulkFileInput" class="file-label">
          <i class="fas fa-folder-open"></i> Select Files
        </label>
        <input type="file" id="bulkFileInput" class="file-input" multiple accept=".eml,.zip">
      </div>
      
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" id="bulkRdns" name="bulkReplace" value="RDNS" checked>
          <label for="bulkRdns">Use [RDNS]</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="bulkPrpath" name="bulkReplace" value="P_RPATH">
          <label for="bulkPrpath">Use [P_RPATH]</label>
        </div>
      </div>
      
      <div class="action-btns">
        <button id="bulkTransformBtn" class="btn"><i class="fas fa-magic"></i> Transform Headers</button>
        <button id="bulkIpBtn" class="btn btn-warning"><i class="fas fa-plus"></i> Add [IP] Tag</button>
        <button id="bulkTemplateBtn" class="btn btn-success"><i class="fas fa-file-alt"></i> Use Template</button>
      </div>
      
      <div class="template-container" id="bulkTemplateContainer" style="display: none; margin-top: 1.5rem;">
        <textarea id="bulkTemplateInput" placeholder="Enter your template text here. Use [newsletter] where you want the processed email content to appear."></textarea>
        <button id="bulkProcessTemplateBtn" class="btn" style="margin-top: 1rem;"><i class="fas fa-cogs"></i> Process with Template</button>
      </div>
      
      <div class="results-area" id="bulkResults"></div>
    </div>
    
    <!-- MBOX Converter -->
    <div id="mbox-converter" class="tool-section">
      <button class="back-btn"><i class="fas fa-arrow-left"></i> Back to Tools</button>
      <h2 class="section-title"><i class="fas fa-box-archive"></i> MBOX Converter</h2>
      
      <div class="info-message" style="margin-bottom: 1rem; font-size: 0.85rem; color: var(--gray);">
        <i class="fas fa-info-circle"></i> Download your newsletters from <a href="https://takeout.google.com/" target="_blank">Google Takeout</a>
      </div>
      
      <div class="upload-area" id="mboxUploadArea">
        <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--warning); margin-bottom: 0.8rem;"></i>
        <p>Drag and drop an MBOX file or .zip archive here</p>
        <p>or</p>
        <label for="mboxFileInput" class="file-label">
          <i class="fas fa-folder-open"></i> Select File
        </label>
        <input type="file" id="mboxFileInput" class="file-input" accept=".mbox,.zip">
      </div>
      
      <div class="action-btns">
        <button id="mboxConvertBtn" class="btn"><i class="fas fa-exchange-alt"></i> Convert to EML</button>
      </div>
      
      <div id="progress" style="text-align: center;">
        Processing... <span id="progressCount">0</span> messages converted
      </div>
      
      <div class="results-area" id="mboxResults"></div>
      
      <button id="mboxDownloadAll" class="btn" style="display: none; margin-top: 1rem;">
        <i class="fas fa-file-archive"></i> Download All as ZIP
      </button>
    </div>
    
    <!-- Bulk Header Remover -->
    <div id="bulk-remover" class="tool-section">
      <button class="back-btn"><i class="fas fa-arrow-left"></i> Back to Tools</button>
      <h2 class="section-title"><i class="fas fa-trash-alt"></i> Bulk Header Remover</h2>
      
      <div class="upload-area" id="removerUploadArea">
        <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--danger); margin-bottom: 0.8rem;"></i>
        <p>Drag and drop multiple .eml files or .zip archives here</p>
        <p>or</p>
        <label for="removerFileInput" class="file-label">
          <i class="fas fa-folder-open"></i> Select Files
        </label>
        <input type="file" id="removerFileInput" class="file-input" multiple accept=".eml,.zip">
      </div>
      
      <div class="action-btns">
        <button id="removerTransformBtn" class="btn"><i class="fas fa-eraser"></i> Remove Headers</button>
        <button id="removerTemplateBtn" class="btn btn-success"><i class="fas fa-file-alt"></i> Use Template</button>
      </div>
      
      <div class="template-container" id="removerTemplateContainer" style="display: none; margin-top: 1.5rem;">
        <textarea id="removerTemplateInput" placeholder="Enter your template text here. Use [newsletter] where you want the processed email content to appear."></textarea>
        <button id="removerProcessTemplateBtn" class="btn" style="margin-top: 1rem;"><i class="fas fa-cogs"></i> Process with Template</button>
      </div>
      
      <div class="results-area" id="removerResults"></div>
    </div>
    
    <!-- Single Header Remover -->
    <div id="single-remover" class="tool-section">
      <button class="back-btn"><i class="fas fa-arrow-left"></i> Back to Tools</button>
      <h2 class="section-title"><i class="fas fa-envelope-open-text"></i> Single Header Remover</h2>
      
      <textarea id="singleRemoverInput" placeholder="Paste your newsletter content here..."></textarea>
      
      <div class="action-btns">
        <button id="singleRemoverBtn" class="btn"><i class="fas fa-eraser"></i> Remove Headers</button>
        <button id="singleRemoverCopyBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copy</button>
        <button id="singleRemoverClearBtn" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Clear</button>
      </div>
      
      <textarea id="singleRemoverOutput" placeholder="Processed newsletter content will appear here..." readonly></textarea>
    </div>
    
    <!-- Domain and IP Extractor -->
    <div id="domain-extractor" class="tool-section">
      <button class="back-btn"><i class="fas fa-arrow-left"></i> Back to Tools</button>
      <h2 class="section-title"><i class="fas fa-globe"></i> Domain & IP Extractor</h2>
      
      <textarea id="domainExtractorInput" placeholder="Paste your text with domains and IPs here..."></textarea>
      
      <div class="action-btns">
        <button id="domainExtractorBtn" class="btn"><i class="fas fa-search"></i> Extract</button>
        <button id="domainExtractorCopyBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copy</button>
        <button id="domainExtractorClearBtn" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Clear</button>
      </div>
      
      <textarea id="domainExtractorOutput" placeholder="Extracted domains with their associated IPs will appear here..." readonly></textarea>
    </div>
    
  
     <!-- Back to Top Button with Refresh Functionality -->
  <button class="back-to-top" id="backToTopBtn" title="Refresh & Back to Top">
    <i class="fas fa-sync-alt"></i>
  </button>

    <footer>
      <p><strong>CMH6 Newsletter Toolkit</strong></p>
      <p>Created by Hanae HM & CMH6 Team</p>
    </footer>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script>
    // Tool navigation
    const toolCards = document.querySelectorAll('.tool-card');
    const toolSections = document.querySelectorAll('.tool-section');
    const backButtons = document.querySelectorAll('.back-btn');
    
    // Clear tool data when going back
    function clearToolData(toolId) {
      switch(toolId) {
        case 'single-transformer':
          document.getElementById('singleInput').value = '';
          document.getElementById('singleOutput').value = '';
          break;
        case 'bulk-transformer':
          document.getElementById('bulkFileInput').value = '';
          document.getElementById('bulkResults').innerHTML = '';
          document.getElementById('bulkTemplateInput').value = '';
          document.getElementById('bulkTemplateContainer').style.display = 'none';
          break;
        case 'mbox-converter':
          document.getElementById('mboxFileInput').value = '';
          document.getElementById('mboxResults').innerHTML = '';
          document.getElementById('mboxDownloadAll').style.display = 'none';
          break;
        case 'bulk-remover':
          document.getElementById('removerFileInput').value = '';
          document.getElementById('removerResults').innerHTML = '';
          document.getElementById('removerTemplateInput').value = '';
          document.getElementById('removerTemplateContainer').style.display = 'none';
          break;
        case 'single-remover':
          document.getElementById('singleRemoverInput').value = '';
          document.getElementById('singleRemoverOutput').value = '';
          break;
        case 'domain-extractor':
          document.getElementById('domainExtractorInput').value = '';
          document.getElementById('domainExtractorOutput').value = '';
          break;
        case 'dns-generator':
          document.getElementById('spf-domains').value = '';
          document.getElementById('spf-ips').value = '';
          document.getElementById('spf-result').innerHTML = '';
          document.getElementById('spf-external-domains').value = '';
          document.getElementById('spf-external-ips').value = '';
          document.getElementById('spf-external-result').innerHTML = '';
          document.getElementById('txt-input').value = '';
          document.getElementById('txt-result').innerHTML = '';
          break;
      }
    }
    
    // Show tool section when card is clicked
    toolCards.forEach(card => {
      card.addEventListener('click', function() {
        const toolId = this.getAttribute('data-tool');
        
        // Hide all sections
        toolSections.forEach(section => {
          section.classList.remove('active');
        });
        
        // Show selected section
        document.getElementById(toolId).classList.add('active');
        
        // Scroll to section
        document.getElementById(toolId).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });
    
    // Back button functionality
    backButtons.forEach(button => {
      button.addEventListener('click', function() {
        // Get the active tool section
        const activeSection = document.querySelector('.tool-section.active');
        if (activeSection) {
          clearToolData(activeSection.id);
        }
        
        // Hide all sections
        toolSections.forEach(section => {
          section.classList.remove('active');
        });
        
        // Scroll back to top
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
    });

    // DNS Generator Tab functionality
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', function() {
        const tabId = this.getAttribute('data-tab');
        
        // Remove active class from all tabs and content
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        // Add active class to clicked tab and corresponding content
        this.classList.add('active');
        document.getElementById(`${tabId}-tab`).classList.add('active');
      });
    });

    // Initialize all tools when page loads
    document.addEventListener('DOMContentLoaded', function() {
      initSingleTransformer();
      initBulkTransformer();
      initMboxConverter();
      initBulkRemover();
      initSingleRemover();
      initDomainExtractor();
      initDnsGenerator();
    });

    // Helper function for button feedback
    function showButtonFeedback(button, message, duration = 2000) {
      const originalText = button.innerHTML;
      button.innerHTML = `<i class="fas fa-check"></i> ${message}`;
      button.disabled = true;
      
      setTimeout(() => {
        button.innerHTML = originalText;
        button.disabled = false;
      }, duration);
    }

    // =============================================
    // SINGLE EMAIL HEADER TRANSFORMER
    // =============================================
    function initSingleTransformer() {
      const transformBtn = document.getElementById('singleTransformBtn');
      const ipBtn = document.getElementById('singleIpBtn');
      const copyBtn = document.getElementById('singleCopyBtn');
      const clearBtn = document.getElementById('singleClearBtn');
      const inputText = document.getElementById('singleInput');
      const outputText = document.getElementById('singleOutput');

      transformBtn.addEventListener('click', () => {
        transformHeaders(false);
        showButtonFeedback(transformBtn, "Done!");
      });

      ipBtn.addEventListener('click', () => {
        transformHeaders(true);
        showButtonFeedback(ipBtn, "Done!");
      });

      copyBtn.addEventListener('click', () => {
        if (!outputText.value) {
          showButtonFeedback(copyBtn, "Nothing to copy!");
          return;
        }
        outputText.select();
        document.execCommand("copy");
        showButtonFeedback(copyBtn, "Copied!");
      });

      clearBtn.addEventListener('click', () => {
        inputText.value = '';
        outputText.value = '';
        showButtonFeedback(clearBtn, "Cleared!");
      });

      function transformHeaders(addIP) {
        let input = inputText.value;
        if (!input.trim()) {
          showButtonFeedback(transformBtn, "Paste headers first!");
          return;
        }

        // Get selected replacement option
        const replacement = document.querySelector('input[name="singleReplace"]:checked').value;
        
        // Remove everything from start to Return-Path
        const returnPathIndex = input.indexOf('Return-Path:');
        if (returnPathIndex !== -1) {
          const nextNewLine = input.indexOf('\n', returnPathIndex);
          input = input.substring(nextNewLine + 1);
        }

        let output = input;

        // Replace domains with selected placeholder
        output = output.replace(/(From:\s*.*?<[^@<\s]+)@[^>\s]+/gi, `$1@[${replacement}]`);
        output = output.replace(/(From:\s*[^<\s@]+)@([^\s]+)/gi, `$1@[${replacement}]`);
        output = output.replace(/(Sender:\s*.*?<[^@<\s]+)@[^>\s]+/gi, `$1@[${replacement}]`);
        output = output.replace(/(Sender:\s*[^<\s@]+)@([^\s]+)/gi, `$1@[${replacement}]`);

        // Insert [EID] into Message-ID
        output = output.replace(/(Message-ID:\s*<)([^@]+)(@[^>]+>)/gi, function(_, prefix, id, suffix) {
          const pos = Math.max(1, Math.floor(Math.random() * id.length));
          return prefix + id.slice(0, pos) + '[EID]' + id.slice(pos) + suffix;
        });

        if (addIP) {
          output = output.replace(/^(Subject:.*?)$/im, function(_, subject) {
            return subject.includes('[IP]') ? subject : subject + ' [IP]';
          });
        }

        outputText.value = output;
      }
    }

    // =============================================
    // BULK EMAIL HEADER TRANSFORMER
    // =============================================
    function initBulkTransformer() {
      const dropArea = document.getElementById('bulkUploadArea');
      const fileInput = document.getElementById('bulkFileInput');
      const transformBtn = document.getElementById('bulkTransformBtn');
      const ipBtn = document.getElementById('bulkIpBtn');
      const templateBtn = document.getElementById('bulkTemplateBtn');
      const templateContainer = document.getElementById('bulkTemplateContainer');
      const processTemplateBtn = document.getElementById('bulkProcessTemplateBtn');
      const resultsArea = document.getElementById('bulkResults');

      let filesToProcess = [];

      // Toggle template input visibility
      templateBtn.addEventListener('click', () => {
        templateContainer.style.display = templateContainer.style.display === 'block' ? 'none' : 'block';
        showButtonFeedback(templateBtn, templateContainer.style.display === 'block' ? "Template Shown" : "Template Hidden");
      });

      // Drag and Drop support
      ["dragenter", "dragover"].forEach(event =>
        dropArea.addEventListener(event, e => {
          e.preventDefault();
          e.stopPropagation();
          dropArea.classList.add("dragover");
        })
      );

      ["dragleave", "drop"].forEach(event =>
        dropArea.addEventListener(event, e => {
          e.preventDefault();
          e.stopPropagation();
          dropArea.classList.remove("dragover");
        })
      );

      dropArea.addEventListener("drop", e => {
        e.preventDefault();
        fileInput.files = e.dataTransfer.files;
        handleFileSelection();
      });

      fileInput.addEventListener("change", handleFileSelection);

      async function handleFileSelection() {
        filesToProcess = [];
        const files = Array.from(fileInput.files);
        
        if (files.length === 0) {
          resultsArea.innerHTML = '<p>No files selected</p>';
          return;
        }

        resultsArea.innerHTML = '<p>Processing files...</p>';
        
        try {
          for (const file of files) {
            if (file.name.endsWith('.zip')) {
              const zip = await JSZip.loadAsync(file);
              for (const [relativePath, zipEntry] of Object.entries(zip.files)) {
                if (!zipEntry.dir && zipEntry.name.endsWith('.eml')) {
                  const content = await zipEntry.async('text');
                  filesToProcess.push({
                    name: zipEntry.name.split('/').pop(),
                    content: content
                  });
                }
              }
            } else if (file.name.endsWith('.eml')) {
              const content = await file.text();
              filesToProcess.push({
                name: file.name,
                content: content
              });
            }
          }

          updateFileList();
          showButtonFeedback(transformBtn, `${filesToProcess.length} files ready`);
        } catch (error) {
          resultsArea.innerHTML = `<p style="color:red;">Error processing files: ${error.message}</p>`;
          console.error(error);
        }
      }

      function updateFileList() {
        if (filesToProcess.length === 0) {
          resultsArea.innerHTML = '<p>No valid EML files found</p>';
          return;
        }

        resultsArea.innerHTML = `
          <p><strong>Selected files:</strong> ${filesToProcess.length}</p>
          <ul style="margin-top: 0.5rem; max-height: 200px; overflow-y: auto;">
            ${filesToProcess.map(file => `<li>${file.name}</li>`).join('')}
          </ul>
        `;
      }

      function transformContent(content, addIP) {
        // Get selected replacement option
        const replacement = document.querySelector('input[name="bulkReplace"]:checked').value;
        
        // Remove everything from start to Return-Path
        const returnPathIndex = content.indexOf('Return-Path:');
        if (returnPathIndex !== -1) {
          const nextNewLine = content.indexOf('\n', returnPathIndex);
          content = content.substring(nextNewLine + 1);
        }

        let output = content;

        // Replace domains with selected placeholder
        output = output.replace(/(From:\s*.*?<[^@<\s]+)@[^>\s]+/gi, `$1@[${replacement}]`);
        output = output.replace(/(From:\s*[^<\s@]+)@([^\s]+)/gi, `$1@[${replacement}]`);
        output = output.replace(/(Sender:\s*.*?<[^@<\s]+)@[^>\s]+/gi, `$1@[${replacement}]`);
        output = output.replace(/(Sender:\s*[^<\s@]+)@([^\s]+)/gi, `$1@[${replacement}]`);

        // Insert [EID] into Message-ID
        output = output.replace(/(Message-ID:\s*<)([^@]+)(@[^>]+>)/gi, (_, prefix, id, suffix) => {
          const pos = Math.max(1, Math.floor(Math.random() * id.length));
          return prefix + id.slice(0, pos) + '[EID]' + id.slice(pos) + suffix;
        });

        if (addIP) {
          output = output.replace(/^(Subject:.*?)$/im, (_, subject) =>
            subject.includes('[IP]') ? subject : subject + ' [IP]'
          );
        }

        return output;
      }

      async function processFiles(addIP) {
        if (filesToProcess.length === 0) {
          showButtonFeedback(transformBtn, "Upload files first!");
          return;
        }

        try {
          const zip = new JSZip();
          
          for (const file of filesToProcess) {
            const output = transformContent(file.content, addIP);
            zip.file(file.name, output);
          }

          const blob = await zip.generateAsync({ type: "blob" });
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "transformed_headers.zip";
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(a.href);
          showButtonFeedback(transformBtn, "Downloaded!");
        } catch (error) {
          showButtonFeedback(transformBtn, "Error occurred!");
          console.error(error);
        }
      }

      async function processWithTemplate() {
        if (filesToProcess.length === 0) {
          showButtonFeedback(processTemplateBtn, "Upload files first!");
          return;
        }

        const template = document.getElementById("bulkTemplateInput").value;
        if (!template) {
          showButtonFeedback(processTemplateBtn, "Enter template first!");
          return;
        }

        if (!template.includes("[newsletter]")) {
          showButtonFeedback(processTemplateBtn, 'Add "[newsletter]"!');
          return;
        }

        try {
          const zip = new JSZip();
          
          for (const file of filesToProcess) {
            const transformedContent = transformContent(file.content, false);
            const finalContent = template.replace("[newsletter]", transformedContent);
            zip.file(file.name, finalContent);
          }

          const blob = await zip.generateAsync({ type: "blob" });
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "templated_emails.zip";
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(a.href);
          showButtonFeedback(processTemplateBtn, "Downloaded!");
        } catch (error) {
          showButtonFeedback(processTemplateBtn, "Error occurred!");
          console.error(error);
        }
      }

      transformBtn.addEventListener('click', () => processFiles(false));
      ipBtn.addEventListener('click', () => processFiles(true));
      processTemplateBtn.addEventListener('click', processWithTemplate);
    }

    // =============================================
    // MBOX CONVERTER
    // =============================================
    function initMboxConverter() {
      const fileInput = document.getElementById('mboxFileInput');
      const convertBtn = document.getElementById('mboxConvertBtn');
      const progress = document.getElementById('progress');
      const progressCount = document.getElementById('progressCount');
      const resultsDiv = document.getElementById('mboxResults');
      const downloadAllBtn = document.getElementById('mboxDownloadAll');

      convertBtn.addEventListener('click', async () => {
        await convertMboxToEml();
        showButtonFeedback(convertBtn, "Processing...");
      });
      
      downloadAllBtn.addEventListener('click', async () => {
        await downloadAllAsZip();
        showButtonFeedback(downloadAllBtn, "Downloading...");
      });

      async function convertMboxToEml() {
        resultsDiv.innerHTML = '';
        downloadAllBtn.style.display = 'none';
        
        if (fileInput.files.length === 0) {
          showButtonFeedback(convertBtn, "Add MBOX content!");
          return;
        }
        
        progress.style.display = 'block';
        
        try {
          const files = [];
          const file = fileInput.files[0];
          
          if (file.name.endsWith('.zip')) {
            const zip = await JSZip.loadAsync(file);
            for (const [relativePath, zipEntry] of Object.entries(zip.files)) {
              if (!zipEntry.dir && zipEntry.name.endsWith('.mbox')) {
                const content = await zipEntry.async('text');
                files.push({
                  name: zipEntry.name.split('/').pop(),
                  content: content
                });
              }
            }
          } else if (file.name.endsWith('.mbox')) {
            const content = await file.text();
            files.push({
              name: file.name,
              content: content
            });
          }

          if (files.length === 0) {
            resultsDiv.innerHTML = '<p>No valid MBOX files found</p>';
            progress.style.display = 'none';
            showButtonFeedback(convertBtn, "No files found!");
            return;
          }

          const zip = new JSZip();
          let count = 0;
          
          for (const file of files) {
            const messages = parseMbox(file.content);
            progressCount.textContent = messages.length;
            
            if (messages.length === 0) {
              resultsDiv.innerHTML = '<p>No messages found in the MBOX file.</p>';
              progress.style.display = 'none';
              showButtonFeedback(convertBtn, "No messages!");
              return;
            }
            
            for (const message of messages) {
              const emlContent = message.raw;
              
              // Extract subject from headers
              let subject = extractHeader(emlContent, 'Subject') || `No_Subject_${count + 1}`;
              
              // Clean subject for filename
              const cleanSubject = subject
                .replace(/[^\w\s-]/g, '')
                .replace(/\s+/g, ' ')
                .trim()
                .substring(0, 100)
                .replace(/\s/g, '_');
              
              const filename = `${cleanSubject}_${count + 1}.eml`;
              
              // Create download link for individual message
              const blob = new Blob([emlContent], { type: 'message/rfc822' });
              const url = URL.createObjectURL(blob);
              
              // Create message info display
              const messageDiv = document.createElement('div');
              messageDiv.className = 'message-info';
              
              const link = document.createElement('a');
              link.href = url;
              link.download = filename;
              link.textContent = `Download: ${filename}`;
              link.className = 'download-link';
              
              const details = document.createElement('div');
              details.className = 'message-details';
              details.textContent = `Subject: ${subject}`;
              
              messageDiv.appendChild(link);
              messageDiv.appendChild(details);
              resultsDiv.appendChild(messageDiv);
              
              // Add to ZIP
              zip.file(filename, emlContent);
              
              count++;
              progressCount.textContent = count;
            }
          }
          
          progress.style.display = 'none';
          
          if (count > 0) {
            // Store ZIP for download
            window.mboxZip = zip;
            downloadAllBtn.style.display = 'block';
          }
          
          showButtonFeedback(convertBtn, "Conversion done!");
        } catch (error) {
          console.error('Error:', error);
          resultsDiv.innerHTML = `<p style="color: red;">Error processing MBOX file: ${error.message}</p>`;
          progress.style.display = 'none';
          showButtonFeedback(convertBtn, "Error occurred!");
        }
      }
      
      function parseMbox(content) {
        const messages = [];
        const lines = content.split(/\r?\n/);
        let currentMessage = [];
        let inMessage = false;
        
        for (const line of lines) {
          if (line.startsWith('From ') && currentMessage.length > 0) {
            // New message starting, save the previous one
            messages.push({ raw: currentMessage.join('\n') });
            currentMessage = [line];
            inMessage = true;
          } else if (line.startsWith('From ') && !inMessage) {
            // First message starting
            currentMessage = [line];
            inMessage = true;
          } else if (inMessage) {
            currentMessage.push(line);
          }
        }
        
        // Add the last message
        if (currentMessage.length > 0) {
          messages.push({ raw: currentMessage.join('\n') });
        }
        
        return messages;
      }
      
      function extractHeader(emailContent, headerName) {
        const headerRegex = new RegExp(`^${headerName}:\\s*(.*)$`, 'im');
        const match = emailContent.match(headerRegex);
        return match ? match[1].trim() : null;
      }
      
      async function downloadAllAsZip() {
        if (!window.mboxZip) {
          showButtonFeedback(downloadAllBtn, "Nothing to download!");
          return;
        }
        
        const content = await window.mboxZip.generateAsync({ type: 'blob' });
        const url = URL.createObjectURL(content);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'converted_emails.zip';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        showButtonFeedback(downloadAllBtn, "Downloaded!");
      }
    }

    // =============================================
    // BULK HEADER REMOVER
    // =============================================
    function initBulkRemover() {
      const dropArea = document.getElementById('removerUploadArea');
      const fileInput = document.getElementById('removerFileInput');
      const transformBtn = document.getElementById('removerTransformBtn');
      const templateBtn = document.getElementById('removerTemplateBtn');
      const templateContainer = document.getElementById('removerTemplateContainer');
      const processTemplateBtn = document.getElementById('removerProcessTemplateBtn');
      const resultsArea = document.getElementById('removerResults');

      let filesToProcess = [];

      // Toggle template input visibility
      templateBtn.addEventListener('click', () => {
        const show = templateContainer.style.display === 'block';
        templateContainer.style.display = show ? 'none' : 'block';
        showButtonFeedback(templateBtn, show ? "Template Hidden" : "Template Shown");
      });

      // Drag and Drop support
      ["dragenter", "dragover"].forEach(event => {
        dropArea.addEventListener(event, e => {
          e.preventDefault();
          dropArea.classList.add("dragover");
        });
      });

      ["dragleave", "drop"].forEach(event => {
        dropArea.addEventListener(event, e => {
          e.preventDefault();
          dropArea.classList.remove("dragover");
        });
      });

      dropArea.addEventListener("drop", e => {
        e.preventDefault();
        fileInput.files = e.dataTransfer.files;
        handleFileSelection();
      });

      fileInput.addEventListener("change", handleFileSelection);

      async function handleFileSelection() {
        filesToProcess = [];
        const files = Array.from(fileInput.files);
        
        if (files.length === 0) {
          resultsArea.innerHTML = '<p>No files selected</p>';
          return;
        }

        resultsArea.innerHTML = '<p>Processing files...</p>';
        
        try {
          for (const file of files) {
            if (file.name.endsWith('.zip')) {
              const zip = await JSZip.loadAsync(file);
              for (const [relativePath, zipEntry] of Object.entries(zip.files)) {
                if (!zipEntry.dir && zipEntry.name.endsWith('.eml')) {
                  const content = await zipEntry.async('text');
                  filesToProcess.push({
                    name: zipEntry.name.split('/').pop(),
                    content: content
                  });
                }
              }
            } else if (file.name.endsWith('.eml')) {
              const content = await file.text();
              filesToProcess.push({
                name: file.name,
                content: content
              });
            }
          }

          updateFileList();
          showButtonFeedback(transformBtn, `${filesToProcess.length} files ready`);
        } catch (error) {
          resultsArea.innerHTML = `<p style="color:red;">Error processing files: ${error.message}</p>`;
          console.error(error);
        }
      }

      function updateFileList() {
        if (filesToProcess.length === 0) {
          resultsArea.innerHTML = '<p>No valid EML files found</p>';
          return;
        }

        resultsArea.innerHTML = `
          <p><strong>Selected files:</strong> ${filesToProcess.length}</p>
          <ul style="margin-top: 0.5rem; max-height: 200px; overflow-y: auto;">
            ${filesToProcess.map(file => `<li>${file.name}</li>`).join('')}
          </ul>
        `;
      }

      function extractBody(content) {
        let headerEnd = content.indexOf('\r\n\r\n');
        if (headerEnd !== -1) return content.slice(headerEnd + 4).trim();
        headerEnd = content.indexOf('\n\n');
        if (headerEnd !== -1) return content.slice(headerEnd + 2).trim();
        const htmlStart = content.indexOf('<');
        if (htmlStart !== -1) return content.slice(htmlStart).trim();
        return '';
      }

      async function processFiles() {
        if (filesToProcess.length === 0) {
          showButtonFeedback(transformBtn, "Upload files first!");
          return;
        }

        try {
          const zip = new JSZip();
          
          for (const file of filesToProcess) {
            const body = extractBody(file.content);
            if (body) {
              const name = file.name.replace(/\.eml$/i, '_body.txt');
              zip.file(name, body);
            } else {
              resultsArea.innerHTML += `<p style="color:red;">No body: ${file.name}</p>`;
            }
          }

          const blob = await zip.generateAsync({ type: "blob" });
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "email_bodies_only.zip";
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(a.href);
          showButtonFeedback(transformBtn, "Downloaded!");
        } catch (error) {
          showButtonFeedback(transformBtn, "Error occurred!");
          console.error(error);
        }
      }

      async function processWithTemplate() {
        if (filesToProcess.length === 0) {
          showButtonFeedback(processTemplateBtn, "Upload files first!");
          return;
        }

        const template = document.getElementById("removerTemplateInput").value;
        if (!template) {
          showButtonFeedback(processTemplateBtn, "Enter template first!");
          return;
        }

        if (!template.includes("[newsletter]")) {
          showButtonFeedback(processTemplateBtn, 'Add "[newsletter]"!');
          return;
        }

        try {
          const zip = new JSZip();
          
          for (const file of filesToProcess) {
            const body = extractBody(file.content);
            const final = template.replace("[newsletter]", body);
            zip.file(file.name, final);
          }

          const blob = await zip.generateAsync({ type: "blob" });
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "templated_emails.zip";
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(a.href);
          showButtonFeedback(processTemplateBtn, "Downloaded!");
        } catch (error) {
          showButtonFeedback(processTemplateBtn, "Error occurred!");
          console.error(error);
        }
      }

      transformBtn.addEventListener('click', processFiles);
      processTemplateBtn.addEventListener('click', processWithTemplate);
    }

    // =============================================
    // SINGLE HEADER REMOVER
    // =============================================
    function initSingleRemover() {
      const inputText = document.getElementById('singleRemoverInput');
      const outputText = document.getElementById('singleRemoverOutput');
      const removeBtn = document.getElementById('singleRemoverBtn');
      const copyBtn = document.getElementById('singleRemoverCopyBtn');
      const clearBtn = document.getElementById('singleRemoverClearBtn');
      
      removeBtn.addEventListener('click', removeHeaders);
      copyBtn.addEventListener('click', copyOutput);
      clearBtn.addEventListener('click', clearAll);
      
      function removeHeaders() {
        if (!inputText.value.trim()) {
          showButtonFeedback(removeBtn, "Paste content first!");
          return;
        }
        
        const content = inputText.value;
        let output = content;
        
        // First try standard \r\n\r\n (Windows)
        let headerEnd = output.indexOf('\r\n\r\n');
        if (headerEnd !== -1) {
          output = output.slice(headerEnd + 4).trim();
        } else {
          // Then try \n\n (Unix)
          headerEnd = output.indexOf('\n\n');
          if (headerEnd !== -1) {
            output = output.slice(headerEnd + 2).trim();
          } else {
            // If no empty line found, try to find first HTML tag
            const htmlStart = output.indexOf('<');
            if (htmlStart !== -1) {
              output = output.slice(htmlStart).trim();
            } else {
              showButtonFeedback(removeBtn, "No headers found!");
              return;
            }
          }
        }
        
        outputText.value = output;
        showButtonFeedback(removeBtn, "Headers removed!");
      }
      
      function copyOutput() {
        if (!outputText.value.trim()) {
          showButtonFeedback(copyBtn, "Nothing to copy!");
          return;
        }
        
        outputText.select();
        document.execCommand('copy');
        showButtonFeedback(copyBtn, "Copied!");
      }
      
      function clearAll() {
        inputText.value = '';
        outputText.value = '';
        showButtonFeedback(clearBtn, "Cleared!");
      }
    }

    // =============================================
    // DOMAIN & IP EXTRACTOR
    // =============================================
    function initDomainExtractor() {
      const extractBtn = document.getElementById('domainExtractorBtn');
      const copyBtn = document.getElementById('domainExtractorCopyBtn');
      const clearBtn = document.getElementById('domainExtractorClearBtn');
      const inputText = document.getElementById('domainExtractorInput');
      const outputText = document.getElementById('domainExtractorOutput');

      extractBtn.addEventListener('click', extractDomains);
      copyBtn.addEventListener('click', copyContent);
      clearBtn.addEventListener('click', clearContent);

      function extractDomains() {
        const text = inputText.value.trim();
        if (!text) {
          showButtonFeedback(extractBtn, "Enter text first!");
          return;
        }

        // Extract IPs and domains
        const ips = text.match(/\d+\.\d+\.\d+\.\d+/g) || [];
        const domains = text.match(/[a-zA-Z0-9.-]+\.[a-z]+/g) || [];

        // Create mapping of domains to IPs
        const domainToIps = {};
        
        // Associate IPs with domains (simple sequential matching)
        ips.forEach((ip, index) => {
          const domain = domains[index];
          if (domain) {
            if (!domainToIps[domain]) {
              domainToIps[domain] = [];
            }
            if (!domainToIps[domain].includes(ip)) { // Prevent duplicate IPs
              domainToIps[domain].push(ip);
            }
          }
        });

        // Format the output as clean list (not JSON)
        let output = '';
        for (const [domain, ipList] of Object.entries(domainToIps)) {
          if (ipList.length > 0) {
            output += `${domain}\n`;
            ipList.forEach(ip => {
              output += `${ip}\n`;
            });
            output += '\n'; // Add extra space between domain groups
          }
        }

        outputText.value = output.trim(); // Remove any trailing whitespace
        showButtonFeedback(extractBtn, "Extraction complete!");
      }

      function copyContent() {
        if (!outputText.value.trim()) {
          showButtonFeedback(copyBtn, "Nothing to copy!");
          return;
        }
        outputText.select();
        document.execCommand('copy');
        showButtonFeedback(copyBtn, "Copied!");
      }

      function clearContent() {
        inputText.value = '';
        outputText.value = '';
        showButtonFeedback(clearBtn, "Cleared!");
      }
    }

// Back to Top Button with Tool Refresh
const backToTopBtn = document.getElementById('backToTopBtn');

window.addEventListener('scroll', function() {
  if (window.pageYOffset > 300) {
    backToTopBtn.classList.add('visible');
  } else {
    backToTopBtn.classList.remove('visible');
  }
});

backToTopBtn.addEventListener('click', function() {
  // Clear all active tool sections
  const activeSection = document.querySelector('.tool-section.active');
  if (activeSection) {
    clearToolData(activeSection.id);
    activeSection.classList.remove('active');
  }
  
  // Reset all tool inputs
  resetAllTools();
  
  // Scroll to top with smooth behavior
  window.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
});

function resetAllTools() {
  // Clear all textareas
  document.querySelectorAll('textarea').forEach(textarea => {
    textarea.value = '';
  });
  
  // Clear all file inputs
  document.querySelectorAll('.file-input').forEach(input => {
    input.value = '';
  });
  
  // Clear all results areas
  document.querySelectorAll('.results-area').forEach(area => {
    area.innerHTML = '';
  });
  
  // Hide all template containers
  document.querySelectorAll('.template-container').forEach(container => {
    container.style.display = 'none';
  });
  
  // Reset radio buttons to default
  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    if (radio.id.includes('Rdns')) {
      radio.checked = true;
    } else {
      radio.checked = false;
    }
  });
  
  // Hide progress indicator and download button for MBOX converter
  document.getElementById('progress').style.display = 'none';
  document.getElementById('mboxDownloadAll').style.display = 'none';
}

function clearToolData(toolId) {
  switch(toolId) {
    case 'single-transformer':
      document.getElementById('singleInput').value = '';
      document.getElementById('singleOutput').value = '';
      break;
    case 'bulk-transformer':
      document.getElementById('bulkFileInput').value = '';
      document.getElementById('bulkResults').innerHTML = '';
      document.getElementById('bulkTemplateInput').value = '';
      document.getElementById('bulkTemplateContainer').style.display = 'none';
      break;
    case 'mbox-converter':
      document.getElementById('mboxFileInput').value = '';
      document.getElementById('mboxResults').innerHTML = '';
      document.getElementById('mboxDownloadAll').style.display = 'none';
      break;
    case 'bulk-remover':
      document.getElementById('removerFileInput').value = '';
      document.getElementById('removerResults').innerHTML = '';
      document.getElementById('removerTemplateInput').value = '';
      document.getElementById('removerTemplateContainer').style.display = 'none';
      break;
    case 'single-remover':
      document.getElementById('singleRemoverInput').value = '';
      document.getElementById('singleRemoverOutput').value = '';
      break;
    case 'domain-extractor':
      document.getElementById('domainExtractorInput').value = '';
      document.getElementById('domainExtractorOutput').value = '';
      break;
  }
}
   
    </script>
</body>
</html>
